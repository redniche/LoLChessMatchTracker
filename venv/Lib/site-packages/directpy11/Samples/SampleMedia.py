
import time
import d3d11
import d3d11x
from d3d11c import *

#Window is not needed if we are playing only sound files.
window = d3d11.Window()
window.show(SW_SHOW)

#Load the media and play it.
m = d3d11.Media(d3d11x.getResourceDir("Media", "JingleBells.mp3"), window)
m.play()

def mainloop():
    while 1:
        for msg in window.getMessages():
            if msg.code == WM_DESTROY:
                return
            elif msg.code == WM_DP_MEDIAEVENT:
                #Some media event was received.
                print("Media event:", msg.lparam)

        time.sleep(0.01)

mainloop()
