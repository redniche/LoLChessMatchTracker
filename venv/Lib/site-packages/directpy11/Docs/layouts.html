
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Layouts and input layouts &mdash; DirectPython 11 v0.1 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '#',
        VERSION:     '0.1',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="DirectPython 11 v0.1 documentation" href="index.html" />
    <link rel="next" title="Debugging Direct3D and DirectPython" href="debugging.html" />
    <link rel="prev" title="Tutorials and Samples" href="samples.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="debugging.html" title="Debugging Direct3D and DirectPython"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="samples.html" title="Tutorials and Samples"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">DirectPython 11 v0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="layouts-and-input-layouts">
<h1>Layouts and input layouts<a class="headerlink" href="#layouts-and-input-layouts" title="Permalink to this headline">¶</a></h1>
<div class="section" id="layout-descriptions">
<h2>Layout descriptions<a class="headerlink" href="#layout-descriptions" title="Permalink to this headline">¶</a></h2>
<p>To effectively use DirectPython you should understand what layouts mean in Direct3D. If you look it up from
the dictionary you might find something like this:</p>
<dl class="describe">
<dt>
<tt class="descname">layout</tt></dt>
<dd><p>A structured arrangement of items within certain limits.</p>
</dd></dl>

<p>In Direct3D layout describes how the data will be interpreted by the runtime. You create layout descriptions
so that Direct3D knows how your data is laid out and how to use it. For example you might receive a blob of binary data from some
third party library and you want to feed that data to Direct3D. If you know the how the blob is structured
you can tell it to Direct3D through a layout description.</p>
<p>A layout description is a simple structure (<a class="reference external" href="http://msdn.microsoft.com/en-gb/library/ee416244%28VS.85%29.aspx">D3D11_INPUT_ELEMENT_DESC</a>)
with 7 members and in DirectPython it is represened as a tuple of seven items.
There are two uses for this information. Buffers use it to store and retrieve items stored to them. Layouts
describe how to map input data into shaders.</p>
<p>Let&#8217;s take an example. You want to feed three dimensional position information for rendering. Each point is
represented by three floating point numbers (x, y and z).</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">description</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s">&quot;POSITION&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">FORMAT_R32G32B32_FLOAT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">INPUT_PER_VERTEX_DATA</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
<dl class="describe">
<dt>
<tt class="descname">SemanticName [0]</tt></dt>
<dd><p>Semantic name of the element. If you use this description to create a Layout-object this name should
be the same in the .fx-file. If this layout is used only with Buffers it does not have any meaning.</p>
</dd></dl>

<dl class="describe">
<dt>
<tt class="descname">SemanticIndex [1]</tt></dt>
<dd><p>Semantic index can be used if there are more than one element with the same semantic name. For example
a 4x4 matrix will need four elements to describe it.</p>
</dd></dl>

<dl class="describe">
<dt>
<tt class="descname">Format [2]</tt></dt>
<dd><p>Format tells how the element will be interpreted. In this case it consists of three 32-bit floating point numbers.</p>
</dd></dl>

<dl class="describe">
<dt>
<tt class="descname">InputSlot [3]</tt></dt>
<dd><p>The input slot from where this element will be read. It is possible to interleave data into multiple Buffers
and read data simultaneously (when using instancing for example). Device.setVertexBuffers() is
used to bind buffers into these slots.</p>
</dd></dl>

<dl class="describe">
<dt>
<tt class="descname">AlignedByteOffset [4]</tt></dt>
<dd><p>Offset (in bytes) from the start of the first element to the start of this element. It is common to use
D3D11_APPEND_ALIGNED_ELEMENT in here so that correct offsets are calculated automatically. If you have
&#8220;holes&#8221; or other oddities in your data this will be the field to use.</p>
</dd></dl>

<dl class="describe">
<dt>
<tt class="descname">InputSlotClass [5]</tt></dt>
<dd><p>Classs for this element, either INPUT_PER_VERTEX_DATA for normal data or INPUT_PER_INSTANCE_DATA if
the data is used for instancing.</p>
</dd></dl>

<dl class="describe">
<dt>
<tt class="descname">InstanceDataStepRate [6]</tt></dt>
<dd><p>When describing instanced data this tells how many instances to draw using the same per-instance data before advancing
in the buffer by one element.</p>
</dd></dl>

<p>The layout above is very simple and most applications use more complex ones. For example adding two floats to represent texture
coordinates can be done like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">description</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s">&quot;POSITION&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">FORMAT_R32G32B32_FLOAT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">INPUT_PER_VERTEX_DATA</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&quot;TEXTURE&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">FORMAT_R32G32_FLOAT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">APPEND_ALIGNED_ELEMENT</span><span class="p">,</span> <span class="n">INPUT_PER_VERTEX_DATA</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
<p>It is also possible to use other types that floats. See <a class="reference internal" href="d3d11c.html#dxgi-format"><em>Format</em></a>-values for some possible choices (not
all of them are valid or supported, though).</p>
</div>
<div class="section" id="input-layouts">
<h2>Input layouts<a class="headerlink" href="#input-layouts" title="Permalink to this headline">¶</a></h2>
<p>When pushing data to Direct3D the runtime must know how the data is handled by the input assembler. To do this
you must combine a layout description with an Effect pass input signature. This makes sure that data
gets correctly read and used. You can re-use the <a class="reference internal" href="d3d11_layout.html#d3d11.InputLayout" title="d3d11.InputLayout"><tt class="xref py py-class docutils literal"><span class="pre">d3d11.InputLayout</span></tt></a> with other passes if they
share the same input signature.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#Input data description.</span>
<span class="n">inputLayoutDesc</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s">&quot;POSITION&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">FORMAT_R32G32B32_FLOAT</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&quot;TEXTURE&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">FORMAT_R32G32_FLOAT</span><span class="p">),</span>
<span class="p">]</span>

<span class="c">#Load an effect.</span>
<span class="n">effect</span> <span class="o">=</span> <span class="n">Effect</span><span class="p">(</span><span class="s">&quot;SomeEffect.fx&quot;</span><span class="p">)</span>

<span class="c">#Create an input layout object which will know what the data</span>
<span class="c">#looks like and how to feed it to the shader. The data</span>
<span class="c">#defined in the .fx-file must match with &#39;inputLayoutDesc&#39;.</span>
<span class="c">#This input layout is valid with any pass that is compatible</span>
<span class="c">#with first techniques (0) first pass (0).</span>
<span class="n">inputLayout</span> <span class="o">=</span> <span class="n">InputLayout</span><span class="p">(</span><span class="n">inputLayoutDesc</span><span class="p">,</span> <span class="n">effect</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">Layouts and input layouts</a><ul>
<li><a class="reference internal" href="#layout-descriptions">Layout descriptions</a></li>
<li><a class="reference internal" href="#input-layouts">Input layouts</a></li>
</ul>
</li>
</ul>

          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
          
          <p>
            <a href="http://sourceforge.net/projects/directpython11">
            <img src="_images/sf.gif" alt="Get DirectPython 11 at SourceForge.net. Fast, secure and Free Open Source software downloads" /></a>
          </p>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="debugging.html" title="Debugging Direct3D and DirectPython"
             >next</a> |</li>
        <li class="right" >
          <a href="samples.html" title="Tutorials and Samples"
             >previous</a> |</li>
        <li><a href="index.html">DirectPython 11 v0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2010, Heikki Salo.
      Last updated on Aug 08, 2010.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.1.
    </div>
  </body>
</html>